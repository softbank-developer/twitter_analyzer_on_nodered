[{"id":"67acfac.37c5304","type":"tab","label":"SBAnalyzer","disabled":false,"info":""},{"id":"ea2f9eba.cce06","type":"tab","label":"Cloudant初期設定","disabled":false,"info":""},{"id":"f0f1f501.6dff48","type":"tab","label":"分類器作成","disabled":false,"info":""},{"id":"d5a50fbf.bae36","type":"tab","label":"分類器削除","disabled":false,"info":""},{"id":"7b39f5db.8af62c","type":"subflow","name":"リクエスト","info":"","in":[{"x":20,"y":100,"wires":[{"id":"a5c1c8f2.b49098"}]}],"out":[{"x":1220,"y":60,"wires":[{"id":"15e96158.b48c2f","port":0},{"id":"d8b2cfec.d9c0d","port":0}]}]},{"id":"473cacaf.a9b054","type":"ui_tab","z":"","name":"Tweet内訳","icon":"dashboard","order":2},{"id":"afdc99ab.20cf48","type":"ui_group","z":"","name":"Tweet内訳","tab":"473cacaf.a9b054","disp":false,"width":"24"},{"id":"dc8366a.8bf5398","type":"ui_tab","z":"","name":"Main","icon":"dashboard","order":1},{"id":"fcf12abb.4d9738","type":"ui_group","z":"","name":"つながらない","tab":"dc8366a.8bf5398","order":1,"disp":true,"width":"6"},{"id":"22b1f18b.1b8a2e","type":"ui_group","z":"","name":"天災","tab":"dc8366a.8bf5398","order":2,"disp":true,"width":"6"},{"id":"e998707d.e647d","type":"ui_group","z":"","name":"人災","tab":"dc8366a.8bf5398","order":3,"disp":true,"width":"6"},{"id":"95d9d2f3.1d54d","type":"ui_group","z":"","name":"ポジネガ","tab":"dc8366a.8bf5398","order":5,"disp":true,"width":"30"},{"id":"b03cc83.c3d2c38","type":"ui_group","z":"","name":"電車遅延","tab":"dc8366a.8bf5398","order":4,"disp":true,"width":"30"},{"id":"10f7223b.89e04e","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","reset":false},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","dateFormat":"YYYY/MM/DD","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"ad00a12f.ea811","type":"twitter-credentials","z":"","screen_name":"@beiley_db24"},{"id":"a4898cff.016c6","type":"ui_group","z":"","name":"ポジネガ","tab":"e02570ca.0673f","order":1,"disp":true,"width":"6"},{"id":"19f34f1a.b79a81","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","reset":false},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","dateFormat":"YYYY/MM/DD","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"e02570ca.0673f","type":"ui_tab","z":"","name":"SBTwitter","icon":"dashboard"},{"id":"993cb05f.441fa","type":"ui_group","z":"","name":"BOT判断","tab":"e02570ca.0673f","disp":true,"width":"6"},{"id":"92c36e27.caf89","type":"ui_group","z":"","name":"感情分類","tab":"e02570ca.0673f","disp":true,"width":"6"},{"id":"b5cc3a79.7d83a8","type":"ui_group","z":"","name":"Tweet内訳","tab":"e02570ca.0673f","disp":true,"width":"24"},{"id":"1a4f0d2f.f162d3","type":"ui_group","z":"","name":"トータル","tab":"e02570ca.0673f","disp":true,"width":"6"},{"id":"51af84c6.fbc3fc","type":"ui_group","z":"","name":"ポジネガ","tab":"f521592e.0dbc08","order":1,"disp":true,"width":"6"},{"id":"d851e666.6f0e68","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","reset":false},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","dateFormat":"YYYY/MM/DD","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"f521592e.0dbc08","type":"ui_tab","z":"","name":"SBTwitter","icon":"dashboard"},{"id":"e70cec66.bdacb","type":"ui_group","z":"","name":"BOT判断","tab":"f521592e.0dbc08","disp":true,"width":"6"},{"id":"9f2882dc.c3ca6","type":"ui_group","z":"","name":"感情分類","tab":"f521592e.0dbc08","disp":true,"width":"6"},{"id":"ae6a0c0e.0f32d","type":"ui_group","z":"","name":"Tweet内訳","tab":"f521592e.0dbc08","disp":true,"width":"24"},{"id":"5ae445a4.0790ac","type":"ui_group","z":"","name":"トータル","tab":"f521592e.0dbc08","disp":true,"width":"6"},{"id":"84a7c73d.6a36d8","type":"twitter in","z":"67acfac.37c5304","twitter":"","tags":"","user":"false","name":"ツイート収集","topic":"tweets","inputs":1,"x":90,"y":80,"wires":[["a99938cb.518858"]]},{"id":"504d4c0f.0168c4","type":"watson-natural-language-classifier","z":"67acfac.37c5304","name":"NLC:ポジネガ判定","mode":"classify","language":"en","classifier":"","x":390,"y":140,"wires":[["1652f3f8.6846cc"]]},{"id":"7f29af4f.b6f8b","type":"watson-natural-language-classifier","z":"67acfac.37c5304","name":"NLC:BOT判断","mode":"classify","language":"en","classifier":"","x":420,"y":80,"wires":[["53ac6a42.46c274","1652f3f8.6846cc"]]},{"id":"b7a894e8.328e98","type":"watson-natural-language-classifier","z":"67acfac.37c5304","name":"NLC:感情分類","mode":"classify","language":"en","classifier":"","x":380,"y":180,"wires":[["1652f3f8.6846cc"]]},{"id":"439ce50a.232e7c","type":"comment","z":"67acfac.37c5304","name":"ツイートの収集、登録","info":"","x":100,"y":40,"wires":[]},{"id":"f0984ed.75be5b","type":"ui_dropdown","z":"67acfac.37c5304","name":"","label":"","place":"時","group":"a4898cff.016c6","order":5,"width":0,"height":0,"passthru":true,"options":[{"label":"","value":"-","type":"str"},{"label":"","value":0,"type":"num"},{"label":"","value":1,"type":"num"},{"label":"","value":2,"type":"num"},{"label":"","value":3,"type":"num"},{"label":"","value":4,"type":"num"},{"label":"","value":5,"type":"num"},{"label":"","value":6,"type":"num"},{"label":"","value":7,"type":"num"},{"label":"","value":8,"type":"num"},{"label":"","value":9,"type":"num"},{"label":"","value":10,"type":"num"},{"label":"","value":11,"type":"num"},{"label":"","value":12,"type":"num"},{"label":"","value":13,"type":"num"},{"label":"","value":14,"type":"num"},{"label":"","value":15,"type":"num"},{"label":"","value":16,"type":"num"},{"label":"","value":17,"type":"num"},{"label":"","value":18,"type":"num"},{"label":"","value":19,"type":"num"},{"label":"","value":20,"type":"num"},{"label":"","value":21,"type":"num"},{"label":"","value":22,"type":"num"},{"label":"","value":23,"type":"num"}],"payload":"","topic":"","x":80,"y":1260,"wires":[["fe359b88.6f71e8"]]},{"id":"378d049.a7a93fc","type":"ui_date_picker","z":"67acfac.37c5304","name":"","label":"","group":"a4898cff.016c6","order":4,"width":0,"height":0,"passthru":true,"topic":"","x":90,"y":1220,"wires":[["b19ff5ce.722938"]]},{"id":"3c215b4c.6a1f34","type":"ui_chart","z":"67acfac.37c5304","name":"","group":"993cb05f.441fa","order":1,"width":0,"height":0,"label":"分","chartType":"line","legend":"false","xformat":"auto","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1050,"y":680,"wires":[[],[]]},{"id":"3e46f7e9.cb9e58","type":"ui_chart","z":"67acfac.37c5304","name":"","group":"993cb05f.441fa","order":2,"width":0,"height":0,"label":"時","chartType":"line","legend":"false","xformat":"auto","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1050,"y":760,"wires":[[],[]]},{"id":"11921f6.ba85ce1","type":"ui_chart","z":"67acfac.37c5304","name":"","group":"993cb05f.441fa","order":3,"width":0,"height":0,"label":"日","chartType":"line","legend":"false","xformat":"D/M","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"5","removeOlderPoints":"31","removeOlderUnit":"604800","cutout":0,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1050,"y":840,"wires":[[],[]]},{"id":"3b1f1712.a11f48","type":"ui_dropdown","z":"67acfac.37c5304","name":"","label":"","place":"時","group":"993cb05f.441fa","order":5,"width":0,"height":0,"passthru":true,"options":[{"label":"","value":"-","type":"str"},{"label":"","value":0,"type":"num"},{"label":"","value":1,"type":"num"},{"label":"","value":2,"type":"num"},{"label":"","value":3,"type":"num"},{"label":"","value":4,"type":"num"},{"label":"","value":5,"type":"num"},{"label":"","value":6,"type":"num"},{"label":"","value":7,"type":"num"},{"label":"","value":8,"type":"num"},{"label":"","value":9,"type":"num"},{"label":"","value":10,"type":"num"},{"label":"","value":11,"type":"num"},{"label":"","value":12,"type":"num"},{"label":"","value":13,"type":"num"},{"label":"","value":14,"type":"num"},{"label":"","value":15,"type":"num"},{"label":"","value":16,"type":"num"},{"label":"","value":17,"type":"num"},{"label":"","value":18,"type":"num"},{"label":"","value":19,"type":"num"},{"label":"","value":20,"type":"num"},{"label":"","value":21,"type":"num"},{"label":"","value":22,"type":"num"},{"label":"","value":23,"type":"num"}],"payload":"","topic":"","x":80,"y":1400,"wires":[["101b3163.ba325f"]]},{"id":"b8ed6d08.3a127","type":"ui_date_picker","z":"67acfac.37c5304","name":"","label":"","group":"993cb05f.441fa","order":4,"width":0,"height":0,"passthru":true,"topic":"","x":90,"y":1360,"wires":[["420cf44e.cafffc"]]},{"id":"a14c18bd.4329d8","type":"ui_chart","z":"67acfac.37c5304","name":"","group":"92c36e27.caf89","order":1,"width":0,"height":0,"label":"分","chartType":"line","legend":"false","xformat":"auto","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1050,"y":940,"wires":[[],[]]},{"id":"30426667.bb1e4a","type":"ui_chart","z":"67acfac.37c5304","name":"","group":"92c36e27.caf89","order":2,"width":0,"height":0,"label":"時","chartType":"line","legend":"false","xformat":"auto","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1050,"y":1020,"wires":[[],[]]},{"id":"8772cc0f.f90c3","type":"ui_chart","z":"67acfac.37c5304","name":"","group":"92c36e27.caf89","order":3,"width":0,"height":0,"label":"日","chartType":"line","legend":"false","xformat":"D/M","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"5","removeOlderPoints":"31","removeOlderUnit":"604800","cutout":0,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1050,"y":1100,"wires":[[],[]]},{"id":"8a6a11e6.9c49e","type":"ui_dropdown","z":"67acfac.37c5304","name":"","label":"","place":"時","group":"92c36e27.caf89","order":5,"width":0,"height":0,"passthru":true,"options":[{"label":"","value":"-","type":"str"},{"label":"","value":0,"type":"num"},{"label":"","value":1,"type":"num"},{"label":"","value":2,"type":"num"},{"label":"","value":3,"type":"num"},{"label":"","value":4,"type":"num"},{"label":"","value":5,"type":"num"},{"label":"","value":6,"type":"num"},{"label":"","value":7,"type":"num"},{"label":"","value":8,"type":"num"},{"label":"","value":9,"type":"num"},{"label":"","value":10,"type":"num"},{"label":"","value":11,"type":"num"},{"label":"","value":12,"type":"num"},{"label":"","value":13,"type":"num"},{"label":"","value":14,"type":"num"},{"label":"","value":15,"type":"num"},{"label":"","value":16,"type":"num"},{"label":"","value":17,"type":"num"},{"label":"","value":18,"type":"num"},{"label":"","value":19,"type":"num"},{"label":"","value":20,"type":"num"},{"label":"","value":21,"type":"num"},{"label":"","value":22,"type":"num"},{"label":"","value":23,"type":"num"}],"payload":"","topic":"","x":80,"y":1540,"wires":[["9d9d4df6.8ad78"]]},{"id":"1b80804.25c0f8","type":"ui_date_picker","z":"67acfac.37c5304","name":"","label":"","group":"92c36e27.caf89","order":4,"width":0,"height":0,"passthru":true,"topic":"","x":90,"y":1500,"wires":[["96b7269e.86edc8"]]},{"id":"60822e2f.f8ff3","type":"ui_dropdown","z":"67acfac.37c5304","name":"","label":"","place":"分","group":"a4898cff.016c6","order":6,"width":0,"height":0,"passthru":true,"options":[{"label":"","value":"-","type":"str"},{"label":"","value":0,"type":"num"},{"label":"","value":1,"type":"num"},{"label":"","value":2,"type":"num"},{"label":"","value":3,"type":"num"},{"label":"","value":4,"type":"num"},{"label":"","value":5,"type":"num"},{"label":"","value":6,"type":"num"},{"label":"","value":7,"type":"num"},{"label":"","value":8,"type":"num"},{"label":"","value":9,"type":"num"},{"label":"","value":10,"type":"num"},{"label":"","value":11,"type":"num"},{"label":"","value":12,"type":"num"},{"label":"","value":13,"type":"num"},{"label":"","value":14,"type":"num"},{"label":"","value":15,"type":"num"},{"label":"","value":16,"type":"num"},{"label":"","value":17,"type":"num"},{"label":"","value":18,"type":"num"},{"label":"","value":19,"type":"num"},{"label":"","value":20,"type":"num"},{"label":"","value":21,"type":"num"},{"label":"","value":22,"type":"num"},{"label":"","value":23,"type":"num"},{"label":"","value":24,"type":"num"},{"label":"","value":25,"type":"num"},{"label":"","value":26,"type":"num"},{"label":"","value":27,"type":"num"},{"label":"","value":28,"type":"num"},{"label":"","value":29,"type":"num"},{"label":"","value":30,"type":"num"},{"label":"","value":31,"type":"num"},{"label":"","value":32,"type":"num"},{"label":"","value":33,"type":"num"},{"label":"","value":34,"type":"num"},{"label":"","value":35,"type":"num"},{"label":"","value":36,"type":"num"},{"label":"","value":37,"type":"num"},{"label":"","value":38,"type":"num"},{"label":"","value":39,"type":"num"},{"label":"","value":40,"type":"num"},{"label":"","value":41,"type":"num"},{"label":"","value":42,"type":"num"},{"label":"","value":43,"type":"num"},{"label":"","value":44,"type":"num"},{"label":"","value":45,"type":"num"},{"label":"","value":46,"type":"num"},{"label":"","value":47,"type":"num"},{"label":"","value":48,"type":"num"},{"label":"","value":49,"type":"num"},{"label":"","value":50,"type":"num"},{"label":"","value":51,"type":"num"},{"label":"","value":52,"type":"num"},{"label":"","value":53,"type":"num"},{"label":"","value":54,"type":"num"},{"label":"","value":55,"type":"num"},{"label":"","value":56,"type":"num"},{"label":"","value":57,"type":"num"},{"label":"","value":58,"type":"num"},{"label":"","value":59,"type":"num"},{"label":"","value":60,"type":"num"}],"payload":"","topic":"","x":80,"y":1300,"wires":[["31eda02b.53d8b"]]},{"id":"15a6ad96.184272","type":"comment","z":"67acfac.37c5304","name":"ポジネガグラフ","info":"","x":80,"y":380,"wires":[]},{"id":"44e8ef60.e02f6","type":"ui_dropdown","z":"67acfac.37c5304","name":"","label":"","place":"分","group":"993cb05f.441fa","order":6,"width":0,"height":0,"passthru":true,"options":[{"label":"","value":"-","type":"str"},{"label":"","value":0,"type":"num"},{"label":"","value":1,"type":"num"},{"label":"","value":2,"type":"num"},{"label":"","value":3,"type":"num"},{"label":"","value":4,"type":"num"},{"label":"","value":5,"type":"num"},{"label":"","value":6,"type":"num"},{"label":"","value":7,"type":"num"},{"label":"","value":8,"type":"num"},{"label":"","value":9,"type":"num"},{"label":"","value":10,"type":"num"},{"label":"","value":11,"type":"num"},{"label":"","value":12,"type":"num"},{"label":"","value":13,"type":"num"},{"label":"","value":14,"type":"num"},{"label":"","value":15,"type":"num"},{"label":"","value":16,"type":"num"},{"label":"","value":17,"type":"num"},{"label":"","value":18,"type":"num"},{"label":"","value":19,"type":"num"},{"label":"","value":20,"type":"num"},{"label":"","value":21,"type":"num"},{"label":"","value":22,"type":"num"},{"label":"","value":23,"type":"num"},{"label":"","value":"24","type":"str"},{"label":"","value":"25","type":"str"},{"label":"","value":"26","type":"str"},{"label":"","value":"27","type":"str"},{"label":"","value":"28","type":"str"},{"label":"","value":"29","type":"str"},{"label":"","value":"30","type":"str"},{"label":"","value":"31","type":"str"},{"label":"","value":"32","type":"str"},{"label":"","value":"33","type":"str"},{"label":"","value":"34","type":"str"},{"label":"","value":"35","type":"str"},{"label":"","value":"36","type":"str"},{"label":"","value":"37","type":"str"},{"label":"","value":"38","type":"str"},{"label":"","value":"39","type":"str"},{"label":"","value":"40","type":"str"},{"label":"","value":"41","type":"str"},{"label":"","value":"42","type":"str"},{"label":"","value":"43","type":"str"},{"label":"","value":"44","type":"str"},{"label":"","value":"45","type":"str"},{"label":"","value":"46","type":"str"},{"label":"","value":"47","type":"str"},{"label":"","value":"48","type":"str"},{"label":"","value":"49","type":"str"},{"label":"","value":"50","type":"str"},{"label":"","value":"51","type":"str"},{"label":"","value":"52","type":"str"},{"label":"","value":"53","type":"str"},{"label":"","value":"54","type":"str"},{"label":"","value":"55","type":"str"},{"label":"","value":"56","type":"str"},{"label":"","value":"57","type":"str"},{"label":"","value":"58","type":"str"},{"label":"","value":"59","type":"str"},{"label":"","value":"60","type":"str"}],"payload":"","topic":"","x":80,"y":1440,"wires":[["e612584.9fc98a8"]]},{"id":"4951382a.4189d8","type":"ui_dropdown","z":"67acfac.37c5304","name":"","label":"","place":"分","group":"92c36e27.caf89","order":6,"width":0,"height":0,"passthru":true,"options":[{"label":"","value":"-","type":"str"},{"label":"","value":0,"type":"num"},{"label":"","value":1,"type":"num"},{"label":"","value":2,"type":"num"},{"label":"","value":3,"type":"num"},{"label":"","value":4,"type":"num"},{"label":"","value":5,"type":"num"},{"label":"","value":6,"type":"num"},{"label":"","value":7,"type":"num"},{"label":"","value":8,"type":"num"},{"label":"","value":9,"type":"num"},{"label":"","value":10,"type":"num"},{"label":"","value":11,"type":"num"},{"label":"","value":12,"type":"num"},{"label":"","value":13,"type":"num"},{"label":"","value":14,"type":"num"},{"label":"","value":15,"type":"num"},{"label":"","value":16,"type":"num"},{"label":"","value":17,"type":"num"},{"label":"","value":18,"type":"num"},{"label":"","value":19,"type":"num"},{"label":"","value":20,"type":"num"},{"label":"","value":21,"type":"num"},{"label":"","value":22,"type":"num"},{"label":"","value":23,"type":"num"},{"label":"","value":"24","type":"str"},{"label":"","value":"25","type":"str"},{"label":"","value":"26","type":"str"},{"label":"","value":"27","type":"str"},{"label":"","value":"28","type":"str"},{"label":"","value":"29","type":"str"},{"label":"","value":"30","type":"str"},{"label":"","value":"31","type":"str"},{"label":"","value":"32","type":"str"},{"label":"","value":"33","type":"str"},{"label":"","value":"34","type":"str"},{"label":"","value":"35","type":"str"},{"label":"","value":"36","type":"str"},{"label":"","value":"37","type":"str"},{"label":"","value":"38","type":"str"},{"label":"","value":"39","type":"str"},{"label":"","value":"40","type":"str"},{"label":"","value":"41","type":"str"},{"label":"","value":"42","type":"str"},{"label":"","value":"43","type":"str"},{"label":"","value":"44","type":"str"},{"label":"","value":"45","type":"str"},{"label":"","value":"46","type":"str"},{"label":"","value":"47","type":"str"},{"label":"","value":"48","type":"str"},{"label":"","value":"49","type":"str"},{"label":"","value":"50","type":"str"},{"label":"","value":"51","type":"str"},{"label":"","value":"52","type":"str"},{"label":"","value":"53","type":"str"},{"label":"","value":"54","type":"str"},{"label":"","value":"55","type":"str"},{"label":"","value":"56","type":"str"},{"label":"","value":"57","type":"str"},{"label":"","value":"58","type":"str"},{"label":"","value":"59","type":"str"},{"label":"","value":"60","type":"str"}],"payload":"","topic":"","x":80,"y":1580,"wires":[["1d88064c.85aa0a"]]},{"id":"f30749de.9af898","type":"ui_template","z":"67acfac.37c5304","group":"b5cc3a79.7d83a8","name":"Tweet内訳","order":0,"width":"24","height":"10","format":"<div>\n<table style=\"width:100%\">\n  <tr>\n    <th>No.</th>\n    <th>Class</th>\n    <th>年</th>\n    <th>月</th>\n    <th>日</th>\n    <th>時</th>\n    <th>分</th>\n    <th>Tweet</th>\n  </tr>\n  <tr ng-repeat=\"x in msg.payload.rows | limitTo:1000\">\n    <td>{{$index}}</td>\n    <td>{{msg.payload.rows[$index].value[0]}}</td>\n    <td>{{msg.payload.rows[$index].value[2]}}</td>\n    <td>{{msg.payload.rows[$index].value[3]}}</td>\n    <td>{{msg.payload.rows[$index].value[4]}}</td>\n    <td>{{msg.payload.rows[$index].value[5]}}</td>\n    <td>{{msg.payload.rows[$index].value[6]}}</td>\n    <td>{{msg.payload.rows[$index].value[1]}}</td> \n  </tr>\n</table>\n</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":150,"y":1640,"wires":[[]]},{"id":"e0dc8589.24e828","type":"debug","z":"67acfac.37c5304","name":"","active":false,"console":"false","complete":"true","x":570,"y":1220,"wires":[]},{"id":"7cf8a359.79667c","type":"function","z":"67acfac.37c5304","name":"クエリセット","func":"var classifierName = \"posinega\";\nvar viewName = \"posi_nega_text_by_time\";\n\nvar date;\nif (global.get(classifierName + \".date\")) {\n    date = new Date(global.get(classifierName + \".date\"));\n} else {\n    date = new Date();\n}\n\nvar startYear = date.getFullYear();\nvar startMonth = date.getMonth()+1;\nvar startDay = date.getDate();\nvar startHour = \"\";\nvar startMinute = \"\";\n\nvar endYear = date.getFullYear();\nvar endMonth = date.getMonth()+1;\nvar endDay = date.getDate();\nvar endHour = \"\";\nvar endMinute = \"\";\n\nif (isFinite(global.get(classifierName + \".hour\"))) {\n    startHour = \",\" + global.get(classifierName + \".hour\");\n    var endHourNum = +global.get(classifierName + \".hour\") + 1;\n    endHour = \",\" + endHourNum;\n    \n    if (isFinite(global.get(classifierName + \".minute\"))) {\n        endHour = \",\" + global.get(classifierName + \".hour\");\n        \n        startMinute = \",\" + global.get(classifierName + \".minute\");\n        var endMinuteNum = +global.get(classifierName + \".minute\") + 1;\n        endMinute = \",\" + endMinuteNum;\n    }\n} else {\n    date.setDate(date.getDate() + 1);\n    endYear = date.getFullYear();\n    endMonth = date.getMonth()+1;\n    endDay = date.getDate();\n}\n\nvar param = \"startkey=[\" +\n                startYear + \",\" +\n                startMonth + \",\" +\n                startDay +\n                startHour +\n                startMinute +\n            \"]\" +\n            \"&endkey=[\" +\n                endYear + \",\" +\n                endMonth + \",\" +\n                endDay +\n                endHour +\n                endMinute +\n            \"]\";\n\nmsg.url = encodeURI(global.get(\"cloudant.url\") + \"/\" + global.get(\"cloudant.dbname\") + \"/_design/view/_view/\" + viewName + \"?\" + param);\n\nmsg.date = date;\n\nreturn msg;","outputs":1,"noerr":0,"x":420,"y":1260,"wires":[["e0dc8589.24e828","fdbf6507.740c68"]]},{"id":"b19ff5ce.722938","type":"change","z":"67acfac.37c5304","name":"日付セット","rules":[{"t":"set","p":"posinega.date","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":250,"y":1220,"wires":[["7cf8a359.79667c"]]},{"id":"fe359b88.6f71e8","type":"change","z":"67acfac.37c5304","name":"時セット","rules":[{"t":"set","p":"posinega.hour","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1260,"wires":[["7cf8a359.79667c"]]},{"id":"31eda02b.53d8b","type":"change","z":"67acfac.37c5304","name":"分セット","rules":[{"t":"set","p":"posinega.minute","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1300,"wires":[["7cf8a359.79667c"]]},{"id":"2e2aabff.e4ef14","type":"debug","z":"67acfac.37c5304","name":"","active":false,"console":"false","complete":"true","x":730,"y":1220,"wires":[]},{"id":"9b160a34.c5ddd8","type":"debug","z":"67acfac.37c5304","name":"","active":false,"console":"false","complete":"true","x":570,"y":1360,"wires":[]},{"id":"ffad4421.e02f28","type":"function","z":"67acfac.37c5304","name":"クエリセット","func":"var classifierName = \"isbot\";\nvar viewName = \"isbot_text_by_time\";\n\nvar date;\nif (global.get(classifierName + \".date\")) {\n    date = new Date(global.get(classifierName + \".date\"));\n} else {\n    date = new Date();\n}\n\nvar startYear = date.getFullYear();\nvar startMonth = date.getMonth()+1;\nvar startDay = date.getDate();\nvar startHour = \"\";\nvar startMinute = \"\";\n\nvar endYear = date.getFullYear();\nvar endMonth = date.getMonth()+1;\nvar endDay = date.getDate();\nvar endHour = \"\";\nvar endMinute = \"\";\n\nif (isFinite(global.get(classifierName + \".hour\"))) {\n    startHour = \",\" + global.get(classifierName + \".hour\");\n    var endHourNum = +global.get(classifierName + \".hour\") + 1;\n    endHour = \",\" + endHourNum;\n    \n    if (isFinite(global.get(classifierName + \".minute\"))) {\n        endHour = \",\" + global.get(classifierName + \".hour\");\n        \n        startMinute = \",\" + global.get(classifierName + \".minute\");\n        var endMinuteNum = +global.get(classifierName + \".minute\") + 1;\n        endMinute = \",\" + endMinuteNum;\n    }\n} else {\n    date.setDate(date.getDate() + 1);\n    endYear = date.getFullYear();\n    endMonth = date.getMonth()+1;\n    endDay = date.getDate();\n}\n\nvar param = \"startkey=[\" +\n                startYear + \",\" +\n                startMonth + \",\" +\n                startDay +\n                startHour +\n                startMinute +\n            \"]\" +\n            \"&endkey=[\" +\n                endYear + \",\" +\n                endMonth + \",\" +\n                endDay +\n                endHour +\n                endMinute +\n            \"]\";\n\nmsg.url = encodeURI(global.get(\"cloudant.url\") + \"/\" + global.get(\"cloudant.dbname\") + \"/_design/view/_view/\" + viewName + \"?\" + param);\n\nreturn msg;","outputs":1,"noerr":0,"x":420,"y":1400,"wires":[["9b160a34.c5ddd8","132d6d94.fd6402"]]},{"id":"420cf44e.cafffc","type":"change","z":"67acfac.37c5304","name":"日付セット","rules":[{"t":"set","p":"isbot.date","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":250,"y":1360,"wires":[["ffad4421.e02f28"]]},{"id":"101b3163.ba325f","type":"change","z":"67acfac.37c5304","name":"時セット","rules":[{"t":"set","p":"isbot.hour","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1400,"wires":[["ffad4421.e02f28"]]},{"id":"e612584.9fc98a8","type":"change","z":"67acfac.37c5304","name":"分セット","rules":[{"t":"set","p":"isbot.minute","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1440,"wires":[["ffad4421.e02f28"]]},{"id":"557d6ba0.49d684","type":"debug","z":"67acfac.37c5304","name":"","active":false,"console":"false","complete":"true","x":730,"y":1360,"wires":[]},{"id":"f3c4d166.08eee","type":"debug","z":"67acfac.37c5304","name":"","active":false,"console":"false","complete":"true","x":570,"y":1500,"wires":[]},{"id":"fac98b19.36fbd8","type":"function","z":"67acfac.37c5304","name":"クエリセット","func":"var classifierName = \"emotion\";\nvar viewName = \"emotion_text_by_time\";\n\nvar date;\nif (global.get(classifierName + \".date\")) {\n    date = new Date(global.get(classifierName + \".date\"));\n} else {\n    date = new Date();\n}\n\nvar startYear = date.getFullYear();\nvar startMonth = date.getMonth()+1;\nvar startDay = date.getDate();\nvar startHour = \"\";\nvar startMinute = \"\";\n\nvar endYear = date.getFullYear();\nvar endMonth = date.getMonth()+1;\nvar endDay = date.getDate();\nvar endHour = \"\";\nvar endMinute = \"\";\n\nif (isFinite(global.get(classifierName + \".hour\"))) {\n    startHour = \",\" + global.get(classifierName + \".hour\");\n    var endHourNum = +global.get(classifierName + \".hour\") + 1;\n    endHour = \",\" + endHourNum;\n    \n    if (isFinite(global.get(classifierName + \".minute\"))) {\n        endHour = \",\" + global.get(classifierName + \".hour\");\n        \n        startMinute = \",\" + global.get(classifierName + \".minute\");\n        var endMinuteNum = +global.get(classifierName + \".minute\") + 1;\n        endMinute = \",\" + endMinuteNum;\n    }\n} else {\n    date.setDate(date.getDate() + 1);\n    endYear = date.getFullYear();\n    endMonth = date.getMonth()+1;\n    endDay = date.getDate();\n}\n\nvar param = \"startkey=[\" +\n                startYear + \",\" +\n                startMonth + \",\" +\n                startDay +\n                startHour +\n                startMinute +\n            \"]\" +\n            \"&endkey=[\" +\n                endYear + \",\" +\n                endMonth + \",\" +\n                endDay +\n                endHour +\n                endMinute +\n            \"]\";\n\nmsg.url = encodeURI(global.get(\"cloudant.url\") + \"/\" + global.get(\"cloudant.dbname\") + \"/_design/view/_view/\" + viewName + \"?\" + param);\n\nreturn msg;","outputs":1,"noerr":0,"x":420,"y":1540,"wires":[["f3c4d166.08eee","dae72473.0e4898"]]},{"id":"96b7269e.86edc8","type":"change","z":"67acfac.37c5304","name":"日付セット","rules":[{"t":"set","p":"emotion.date","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":250,"y":1500,"wires":[["fac98b19.36fbd8"]]},{"id":"9d9d4df6.8ad78","type":"change","z":"67acfac.37c5304","name":"時セット","rules":[{"t":"set","p":"emotion.hour","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1540,"wires":[["fac98b19.36fbd8"]]},{"id":"1d88064c.85aa0a","type":"change","z":"67acfac.37c5304","name":"分セット","rules":[{"t":"set","p":"emotion.minute","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1580,"wires":[["fac98b19.36fbd8"]]},{"id":"5ad25ebb.e99ad","type":"debug","z":"67acfac.37c5304","name":"","active":false,"console":"false","complete":"true","x":730,"y":1500,"wires":[]},{"id":"180a4dc4.bf5362","type":"comment","z":"67acfac.37c5304","name":"BOT判断グラフ","info":"","x":80,"y":640,"wires":[]},{"id":"48251f5f.69d62","type":"comment","z":"67acfac.37c5304","name":"感情分類グラフ","info":"","x":80,"y":900,"wires":[]},{"id":"98ecc4d6.0252c8","type":"link out","z":"67acfac.37c5304","name":"Tweet内訳","links":["518837fe.9d2ec8"],"x":695,"y":1260,"wires":[]},{"id":"518837fe.9d2ec8","type":"link in","z":"67acfac.37c5304","name":"Tweet内訳","links":["98ecc4d6.0252c8","422db512.a56b5c","6d450bf2.881764"],"x":35,"y":1640,"wires":[["f30749de.9af898"]]},{"id":"e9af7662.418e98","type":"comment","z":"67acfac.37c5304","name":"Tweet内訳へ","info":"","x":790,"y":1260,"wires":[]},{"id":"422db512.a56b5c","type":"link out","z":"67acfac.37c5304","name":"Tweet内訳","links":["518837fe.9d2ec8"],"x":695,"y":1400,"wires":[]},{"id":"a333e674.67f078","type":"comment","z":"67acfac.37c5304","name":"Tweet内訳へ","info":"","x":790,"y":1400,"wires":[]},{"id":"6d450bf2.881764","type":"link out","z":"67acfac.37c5304","name":"Tweet内訳","links":["518837fe.9d2ec8"],"x":695,"y":1540,"wires":[]},{"id":"9224374f.0cdd08","type":"comment","z":"67acfac.37c5304","name":"Tweet内訳へ","info":"","x":790,"y":1540,"wires":[]},{"id":"8d1ec138.b6aa7","type":"change","z":"67acfac.37c5304","name":"分類器名セット","rules":[{"t":"set","p":"classifier","pt":"msg","to":"isbot","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":760,"wires":[["b643677a.23ee68"]]},{"id":"50361f9e.9ea01","type":"change","z":"67acfac.37c5304","name":"分類器名セット","rules":[{"t":"set","p":"classifier","pt":"msg","to":"emotion","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":1020,"wires":[["b643677a.23ee68"]]},{"id":"44538efd.143a8","type":"ui_chart","z":"67acfac.37c5304","name":"","group":"1a4f0d2f.f162d3","order":0,"width":0,"height":0,"label":"ポジネガ","chartType":"pie","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":680,"y":1880,"wires":[[],[]]},{"id":"98d5b4b9.883be8","type":"comment","z":"67acfac.37c5304","name":"トータル円グラフ","info":"","x":90,"y":1720,"wires":[]},{"id":"507ff7ef.8ee018","type":"ui_chart","z":"67acfac.37c5304","name":"","group":"1a4f0d2f.f162d3","order":0,"width":0,"height":0,"label":"BOT判断","chartType":"pie","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":680,"y":2080,"wires":[[],[]]},{"id":"d526b439.a025c8","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"","payloadType":"date","repeat":"60","crontab":"","once":false,"x":110,"y":1760,"wires":[["47f674f4.8a1ccc"]]},{"id":"c2834086.9129a","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"","payloadType":"date","repeat":"60","crontab":"","once":false,"x":110,"y":1960,"wires":[["c63cf340.2185"]]},{"id":"e9b625ef.a45058","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"","payloadType":"date","repeat":"60","crontab":"","once":false,"x":110,"y":2160,"wires":[["6da316e2.4b0648"]]},{"id":"c63cf340.2185","type":"change","z":"67acfac.37c5304","name":"分類器名セット","rules":[{"t":"set","p":"classifier","pt":"msg","to":"isbot","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":1960,"wires":[["55bb4411.a2e23c"]]},{"id":"6da316e2.4b0648","type":"change","z":"67acfac.37c5304","name":"分類器名セット","rules":[{"t":"set","p":"classifier","pt":"msg","to":"emotion","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":2160,"wires":[["8e5bf87a.fe69a8"]]},{"id":"66d27f6a.72a9e","type":"function","z":"ea2f9eba.cce06","name":"Database作成クエリセット","func":"msg.url = encodeURI(global.get(\"cloudant.url\") + \"/\" + global.get(\"cloudant.dbname\"));\n\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":140,"wires":[["91a6ed49.240cc"]]},{"id":"91a6ed49.240cc","type":"http request","z":"ea2f9eba.cce06","name":"","method":"PUT","ret":"obj","url":"","tls":"","x":550,"y":140,"wires":[["714bacab.8ede04"]]},{"id":"a763cdd0.a54ff","type":"function","z":"ea2f9eba.cce06","name":"view作成クエリセット","func":"msg.url = encodeURI(global.get(\"cloudant.url\") + \"/\" + global.get(\"cloudant.dbname\") + \"/_design/view\");\n\n//作成するviewの中身をmsg.payloadに格納する\nmsg.payload = {\n  \"_id\": \"_design/view\",\n  \"views\": {\n    \"count_by_time\": {\n      \"reduce\": \"_count\",\n      \"map\": \"function (doc) {\\n  msec = Date.parse(doc.tweet.created_at);\\n  if (msec) {\\n    //32400000ms足すことで日本時間に合わせる\\n    date = new Date(msec+32400000);\\n    emit([doc.payload.top_class,\\n          date.getFullYear(),\\n          date.getMonth()+1,\\n          date.getDate(),\\n          date.getHours(),\\n          date.getMinutes(),\\n          date.getSeconds()\\n        ]);\\n  }\\n}\"\n    },\n    \"posi_nega_text_by_time\": {\n      \"map\": \"function (doc) {\\n  msec = Date.parse(doc.tweet.created_at);\\n  if (msec) {\\n    if (doc.payload.top_class == \\\"positive\\\" ||\\n        doc.payload.top_class == \\\"neutral\\\" ||\\n        doc.payload.top_class == \\\"negative\\\") {\\n      //32400000ms足すことで日本時間に合わせる\\n      date = new Date(msec+32400000);\\n      emit([date.getFullYear(),\\n            date.getMonth()+1,\\n            date.getDate(),\\n            date.getHours(),\\n            date.getMinutes(),\\n            date.getSeconds()\\n          ],\\n          [doc.payload.top_class,\\n            doc.tweet.text,\\n            date.getFullYear(),\\n            date.getMonth()+1,\\n            date.getDate(),\\n            date.getHours(),\\n            date.getMinutes(),\\n            date.getSeconds()\\n          ]);\\n    }\\n  }\\n}\"\n    },\n    \"isbot_text_by_time\": {\n      \"map\": \"function (doc) {\\n  msec = Date.parse(doc.tweet.created_at);\\n  if (msec) {\\n    if (doc.payload.top_class == \\\"person\\\" ||\\n        doc.payload.top_class == \\\"others\\\") {\\n      //32400000ms足すことで日本時間に合わせる\\n      date = new Date(msec+32400000);\\n      emit([date.getFullYear(),\\n            date.getMonth()+1,\\n            date.getDate(),\\n            date.getHours(),\\n            date.getMinutes(),\\n            date.getSeconds()\\n          ],\\n          [doc.payload.top_class,\\n            doc.tweet.text,\\n            date.getFullYear(),\\n            date.getMonth()+1,\\n            date.getDate(),\\n            date.getHours(),\\n            date.getMinutes(),\\n            date.getSeconds()\\n          ]);\\n    }\\n  }\\n}\"\n    },\n    \"count_by_class\": {\n      \"reduce\": \"_count\",\n      \"map\": \"function (doc) {\\n  if (doc.payload.top_class) {\\n    emit(doc.payload.top_class);\\n  }\\n}\"\n    },\n    \"emotion_text_by_time\": {\n      \"map\": \"function (doc) {\\n  msec = Date.parse(doc.tweet.created_at);\\n  if (msec) {\\n    if (doc.payload.top_class == \\\"喜\\\" ||\\n        doc.payload.top_class == \\\"怒\\\" ||\\n        doc.payload.top_class == \\\"哀\\\" ||\\n        doc.payload.top_class == \\\"楽\\\") {\\n      //32400000ms足すことで日本時間に合わせる\\n      date = new Date(msec+32400000);\\n      emit([date.getFullYear(),\\n            date.getMonth()+1,\\n            date.getDate(),\\n            date.getHours(),\\n            date.getMinutes(),\\n            date.getSeconds()\\n          ],\\n          [doc.payload.top_class,\\n            doc.tweet.text,\\n            date.getFullYear(),\\n            date.getMonth()+1,\\n            date.getDate(),\\n            date.getHours(),\\n            date.getMinutes(),\\n            date.getSeconds()\\n          ]);\\n    }\\n  }\\n}\"\n    },\n    \"sort_by_date\": {\n      \"map\": \"function (doc) {\\n  if (doc.tweet.created_at) {\\n    msec = Date.parse(doc.tweet.created_at);\\n    tweetDate = new Date(msec);\\n    tweetDate.setHours(tweetDate.getHours() + 9);\\n    emit([tweetDate.getFullYear(),\\n          tweetDate.getMonth()+1,\\n          tweetDate.getDate(),\\n          tweetDate.getHours(),\\n          tweetDate.getMinutes(),\\n          tweetDate.getSeconds()],doc);\\n  }\\n}\"\n    }\n  },\n  \"language\": \"javascript\"\n};\n\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":180,"wires":[["377a2842.563658"]]},{"id":"377a2842.563658","type":"http request","z":"ea2f9eba.cce06","name":"","method":"PUT","ret":"obj","url":"","tls":"","x":550,"y":180,"wires":[["f1e609af.96e188"]]},{"id":"c11e1d5c.aa0d","type":"change","z":"ea2f9eba.cce06","name":"Cloudant 設定","rules":[{"t":"set","p":"cloudant.url","pt":"global","to":"","tot":"str"},{"t":"set","p":"cloudant.dbname","pt":"global","to":"twitter_data","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":40,"wires":[[]]},{"id":"8dd25a01.f118e8","type":"inject","z":"ea2f9eba.cce06","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"x":110,"y":40,"wires":[["c11e1d5c.aa0d"]]},{"id":"5593c318.b50bdc","type":"inject","z":"ea2f9eba.cce06","name":"Database作成","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":130,"y":140,"wires":[["66d27f6a.72a9e"]]},{"id":"6d6d3440.29e06c","type":"inject","z":"ea2f9eba.cce06","name":"view作成","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":120,"y":180,"wires":[["a763cdd0.a54ff"]]},{"id":"714bacab.8ede04","type":"debug","z":"ea2f9eba.cce06","name":"","active":true,"console":"false","complete":"false","x":710,"y":140,"wires":[]},{"id":"f1e609af.96e188","type":"debug","z":"ea2f9eba.cce06","name":"","active":true,"console":"false","complete":"false","x":710,"y":180,"wires":[]},{"id":"af903f5b.9afdc","type":"inject","z":"f0f1f501.6dff48","name":"学習データをセットしてクリック","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":190,"y":80,"wires":[["37ca9808.00b268"]]},{"id":"e068f23e.b01c4","type":"comment","z":"f0f1f501.6dff48","name":"NLCに分類器（ポジネガ）作成","info":"","x":150,"y":40,"wires":[]},{"id":"37ca9808.00b268","type":"template","z":"f0f1f501.6dff48","name":"学習データ","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"","output":"str","x":410,"y":80,"wires":[["5b405d.2b56dfa4"]]},{"id":"7d0654f9.24202c","type":"debug","z":"f0f1f501.6dff48","name":"","active":true,"console":"false","complete":"payload","x":830,"y":40,"wires":[]},{"id":"c6379102.c04ca","type":"inject","z":"f0f1f501.6dff48","name":"学習データをセットしてクリック","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":190,"y":220,"wires":[["370617ce.c0b578"]]},{"id":"370617ce.c0b578","type":"template","z":"f0f1f501.6dff48","name":"学習データ","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"","output":"str","x":410,"y":220,"wires":[["3da6ad52.ed0ab2"]]},{"id":"3da6ad52.ed0ab2","type":"watson-natural-language-classifier","z":"f0f1f501.6dff48","name":"分類器作成・トレーニング","mode":"create","language":"ja","classifier":"","x":620,"y":220,"wires":[["74323a1f.aece54","9982ab39.a3ee28"]]},{"id":"74323a1f.aece54","type":"debug","z":"f0f1f501.6dff48","name":"","active":true,"console":"false","complete":"false","x":830,"y":180,"wires":[]},{"id":"7668707a.59494","type":"comment","z":"f0f1f501.6dff48","name":"NLCに分類器（BOT判断）作成","info":"","x":150,"y":180,"wires":[]},{"id":"9a3b1735.d27ab8","type":"template","z":"f0f1f501.6dff48","name":"学習データ","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"","output":"str","x":410,"y":360,"wires":[["1b7adf26.1a86d1"]]},{"id":"26710c05.8109f4","type":"inject","z":"f0f1f501.6dff48","name":"学習データをセットしてクリック","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":190,"y":360,"wires":[["9a3b1735.d27ab8"]]},{"id":"1b7adf26.1a86d1","type":"watson-natural-language-classifier","z":"f0f1f501.6dff48","name":"分類器作成・トレーニング","mode":"create","language":"ja","classifier":"","x":620,"y":360,"wires":[["41f628ed.c3e708","30302db9.a55802"]]},{"id":"41f628ed.c3e708","type":"debug","z":"f0f1f501.6dff48","name":"","active":true,"console":"false","complete":"false","x":830,"y":320,"wires":[]},{"id":"2a7de803.58d608","type":"comment","z":"f0f1f501.6dff48","name":"NLCに分類器（感情）作成","info":"","x":130,"y":320,"wires":[]},{"id":"164c7d1a.d4c963","type":"comment","z":"f0f1f501.6dff48","name":"NLCに登録済みの分類器一覧確認","info":"","x":150,"y":460,"wires":[]},{"id":"e9c6fff6.cb3e8","type":"inject","z":"f0f1f501.6dff48","name":"分類器情報の確認","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":150,"y":500,"wires":[["278dd9dc.fbc576"]]},{"id":"a03cca6a.04ab28","type":"debug","z":"f0f1f501.6dff48","name":"","active":true,"console":"false","complete":"payload","x":450,"y":500,"wires":[]},{"id":"5b405d.2b56dfa4","type":"watson-natural-language-classifier","z":"f0f1f501.6dff48","name":"分類器作成・トレーニング","mode":"create","language":"ja","classifier":"","x":620,"y":80,"wires":[["7d0654f9.24202c","dd3c5bd6.be2f58"]]},{"id":"5c872bf4.ed2de4","type":"catch","z":"f0f1f501.6dff48","name":"Cloudant Insertリトライ","scope":["ce600f1c.dccdb"],"x":690,"y":120,"wires":[["44d73d44.e6c554"]]},{"id":"4f41b212.2a707c","type":"function","z":"f0f1f501.6dff48","name":"クエリセット","func":"var name = \"posinega\";\n\nmsg.payload = {\n    \"_id\" : msg.classifier.classifier_id,\n    \"classifier_id\" : msg.classifier.classifier_id,\n    \"name\" : name,\n    \"created\" : msg.classifier.created\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":1040,"y":80,"wires":[["ce600f1c.dccdb"]]},{"id":"dd3c5bd6.be2f58","type":"change","z":"f0f1f501.6dff48","name":"","rules":[{"t":"set","p":"classifier","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":80,"wires":[["4f41b212.2a707c"]]},{"id":"44d73d44.e6c554","type":"delay","z":"f0f1f501.6dff48","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"500","randomLast":"1","randomUnits":"milliseconds","drop":false,"x":880,"y":120,"wires":[["4f41b212.2a707c"]]},{"id":"cc9f568.39ccca8","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"x":110,"y":300,"wires":[["da68ebd7.5aa9c8"]]},{"id":"da68ebd7.5aa9c8","type":"change","z":"67acfac.37c5304","name":"NLC設定","rules":[{"t":"set","p":"posinega","pt":"global","to":"{\"class\":[\"positive\",\"neutral\",\"negative\"]}","tot":"json"},{"t":"set","p":"isbot","pt":"global","to":"{\"class\":[\"person\",\"others\"]}","tot":"json"},{"t":"set","p":"emotion","pt":"global","to":"{\"class\":[\"喜\",\"怒\",\"哀\",\"楽\"]}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":300,"wires":[[]]},{"id":"ca6859f3.5be388","type":"catch","z":"f0f1f501.6dff48","name":"Cloudant Insertリトライ","scope":["ce600f1c.dccdb"],"x":690,"y":260,"wires":[["27ee05b9.40a0fa"]]},{"id":"27ee05b9.40a0fa","type":"delay","z":"f0f1f501.6dff48","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"500","randomLast":"1","randomUnits":"milliseconds","drop":false,"x":880,"y":260,"wires":[["dd30ed58.16a0d"]]},{"id":"9982ab39.a3ee28","type":"change","z":"f0f1f501.6dff48","name":"","rules":[{"t":"set","p":"classifier","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":220,"wires":[["dd30ed58.16a0d"]]},{"id":"dd30ed58.16a0d","type":"function","z":"f0f1f501.6dff48","name":"クエリセット","func":"var name = \"isbot\";\n\nmsg.payload = {\n    \"_id\" : msg.classifier.classifier_id,\n    \"classifier_id\" : msg.classifier.classifier_id,\n    \"name\" : name,\n    \"created\" : msg.classifier.created\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":1040,"y":220,"wires":[["ce600f1c.dccdb"]]},{"id":"ce600f1c.dccdb","type":"cloudant out","z":"f0f1f501.6dff48","name":"Insert","cloudant":"","database":"classifiers","service":"node-red-twitter-okano-cloudantNoSQLDB","payonly":true,"operation":"insert","x":1190,"y":220,"wires":[]},{"id":"c3d07b9e.e3f808","type":"catch","z":"f0f1f501.6dff48","name":"Cloudant Insertリトライ","scope":["ce600f1c.dccdb"],"x":690,"y":400,"wires":[["afb66af9.65a568"]]},{"id":"afb66af9.65a568","type":"delay","z":"f0f1f501.6dff48","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"500","randomLast":"1","randomUnits":"milliseconds","drop":false,"x":880,"y":400,"wires":[["77e96c0d.69b864"]]},{"id":"30302db9.a55802","type":"change","z":"f0f1f501.6dff48","name":"","rules":[{"t":"set","p":"classifier","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":360,"wires":[["77e96c0d.69b864"]]},{"id":"77e96c0d.69b864","type":"function","z":"f0f1f501.6dff48","name":"クエリセット","func":"var name = \"emotion\";\n\nmsg.payload = {\n    \"_id\" : msg.classifier.classifier_id,\n    \"classifier_id\" : msg.classifier.classifier_id,\n    \"name\" : name,\n    \"created\" : msg.classifier.created\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":1040,"y":360,"wires":[["ce600f1c.dccdb"]]},{"id":"cdd2b111.36b3b","type":"comment","z":"f0f1f501.6dff48","name":"分類器の状態確認（classifier_id指定）","info":"","x":170,"y":580,"wires":[]},{"id":"fc128378.1ae46","type":"watson-natural-language-classifier","z":"f0f1f501.6dff48","name":"分類器状態確認","mode":"classify","language":"en","classifier":"","x":320,"y":620,"wires":[["78720173.9072d"]]},{"id":"78720173.9072d","type":"debug","z":"f0f1f501.6dff48","name":"","active":true,"console":"false","complete":"payload","x":490,"y":620,"wires":[]},{"id":"7545dc2c.004154","type":"inject","z":"f0f1f501.6dff48","name":"分類器状態確認","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":620,"wires":[["fc128378.1ae46"]]},{"id":"278dd9dc.fbc576","type":"cloudant in","z":"f0f1f501.6dff48","name":"検索","cloudant":"","database":"classifiers","service":"node-red-twitter-okano-cloudantNoSQLDB","search":"_all_","design":"","index":"","x":310,"y":500,"wires":[["a03cca6a.04ab28"]]},{"id":"ea522b6d.748bd8","type":"cloudant out","z":"67acfac.37c5304","name":"ツイート情報登録","cloudant":"","database":"twitter_data","service":"node-red-twitter-okano-cloudantNoSQLDB","payonly":false,"operation":"insert","x":770,"y":180,"wires":[]},{"id":"21ee3e89.b1d1b2","type":"change","z":"67acfac.37c5304","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"tweet.text","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":80,"wires":[["504d4c0f.0168c4","b7a894e8.328e98"]]},{"id":"53ac6a42.46c274","type":"switch","z":"67acfac.37c5304","name":"人のみ","property":"payload.top_class","propertyType":"msg","rules":[{"t":"eq","v":"person","vt":"str"}],"checkall":"true","outputs":1,"x":570,"y":80,"wires":[["21ee3e89.b1d1b2"]]},{"id":"1652f3f8.6846cc","type":"delay","z":"67acfac.37c5304","name":"","pauseType":"rate","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":590,"y":180,"wires":[["ea522b6d.748bd8"]]},{"id":"a99938cb.518858","type":"switch","z":"67acfac.37c5304","name":"日本語のみ","property":"lang","propertyType":"msg","rules":[{"t":"eq","v":"ja","vt":"str"}],"checkall":"true","outputs":1,"x":250,"y":80,"wires":[["7f29af4f.b6f8b"]]},{"id":"d3fa938f.55d3c","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"","payloadType":"date","repeat":"2","crontab":"","once":true,"x":470,"y":300,"wires":[["2500ee01.9ae952"]]},{"id":"2500ee01.9ae952","type":"change","z":"67acfac.37c5304","name":"流量制限用","rules":[{"t":"set","p":"request.count","pt":"global","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":300,"wires":[[]]},{"id":"fdbf6507.740c68","type":"http request","z":"67acfac.37c5304","name":"","method":"GET","ret":"obj","url":"","tls":"","x":590,"y":1260,"wires":[["98ecc4d6.0252c8","2e2aabff.e4ef14"]]},{"id":"132d6d94.fd6402","type":"http request","z":"67acfac.37c5304","name":"","method":"GET","ret":"obj","url":"","tls":"","x":590,"y":1400,"wires":[["422db512.a56b5c","557d6ba0.49d684"]]},{"id":"dae72473.0e4898","type":"http request","z":"67acfac.37c5304","name":"","method":"GET","ret":"obj","url":"","tls":"","x":590,"y":1540,"wires":[["5ad25ebb.e99ad","6d450bf2.881764"]]},{"id":"6e4fd0cf.48c35","type":"ui_chart","z":"67acfac.37c5304","name":"","group":"1a4f0d2f.f162d3","order":0,"width":0,"height":0,"label":"感情分類","chartType":"pie","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":680,"y":2280,"wires":[[],[]]},{"id":"aed91a0b.562e58","type":"function","z":"d5a50fbf.bae36","name":"削除対象抽出","func":"msg.target = msg.payload;\nmsg.count = msg.payload.length;\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":400,"wires":[["9b06c740.f91298"]]},{"id":"fb4fb745.0eb6e8","type":"inject","z":"d5a50fbf.bae36","name":"最も古い分類器の削除","topic":"posinega","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":160,"y":80,"wires":[["257fdf65.693a9"]]},{"id":"fcfa635e.c146c","type":"template","z":"d5a50fbf.bae36","name":"削除対象設定","field":"payload","fieldType":"msg","format":"json","syntax":"plain","template":"[\"abc12ex123-nlc-12346\", \"abc12ex123-nlc-12346\"]","output":"json","x":340,"y":400,"wires":[["aed91a0b.562e58"]]},{"id":"748d2ae3.000ab4","type":"comment","z":"d5a50fbf.bae36","name":"最も古い分類器の削除（ポジネガ）","info":"","x":160,"y":40,"wires":[]},{"id":"257fdf65.693a9","type":"cloudant in","z":"d5a50fbf.bae36","name":"検索","cloudant":"","database":"classifiers","service":"node-red-twitter-okano-cloudantNoSQLDB","search":"_all_","design":"","index":"","x":330,"y":180,"wires":[["1fa409d4.053856"]]},{"id":"6d35a37d.b27a0c","type":"inject","z":"d5a50fbf.bae36","name":"最も古い分類器の削除","topic":"isbot","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":160,"y":180,"wires":[["257fdf65.693a9"]]},{"id":"1fa409d4.053856","type":"function","z":"d5a50fbf.bae36","name":"削除対象設定","func":"var name = msg.topic;\nvar id = \"\";\nvar rev = \"\";\nvar created = new Date();\n\nif (Array.isArray(msg.payload)) {\n    for (i = 0; i < msg.payload.length; i++) {\n        if (name == msg.payload[i].name) {\n            if (created.getTime() > new Date(msg.payload[i].created).getTime()) {\n                id = msg.payload[i]._id;\n                rev = msg.payload[i]._rev;\n                created = new Date(msg.payload[i].created);\n            }\n        }\n    }\n}\n\nmsg.payload = id;\nmsg._id = id;\nmsg._rev = rev;\n\nreturn msg;","outputs":1,"noerr":0,"x":480,"y":180,"wires":[["d0d16239.82562","22fc14e4.69c71c"]]},{"id":"d0d16239.82562","type":"watson-natural-language-classifier","z":"d5a50fbf.bae36","name":"分類器削除","mode":"remove","language":"en","classifier":"","x":650,"y":180,"wires":[["2f0a3053.3163e"]]},{"id":"22fc14e4.69c71c","type":"function","z":"d5a50fbf.bae36","name":"Cloudant用設定","func":"msg.payload = { \"_id\" : msg._id, \"_rev\" : msg._rev }\n\nreturn msg;","outputs":1,"noerr":0,"x":660,"y":240,"wires":[["dda15a47.c63cf8"]]},{"id":"e3a8d162.eb6bf","type":"comment","z":"d5a50fbf.bae36","name":"最も古い分類器の削除（BOT判断）","info":"","x":160,"y":140,"wires":[]},{"id":"dda15a47.c63cf8","type":"cloudant out","z":"d5a50fbf.bae36","name":"削除","cloudant":"","database":"classifiers","service":"node-red-twitter-okano-cloudantNoSQLDB","payonly":false,"operation":"delete","x":810,"y":240,"wires":[]},{"id":"2f0a3053.3163e","type":"debug","z":"d5a50fbf.bae36","name":"","active":true,"console":"false","complete":"false","x":810,"y":180,"wires":[]},{"id":"93f2f373.e5f66","type":"inject","z":"d5a50fbf.bae36","name":"最も古い分類器の削除","topic":"emotion","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":160,"y":280,"wires":[["257fdf65.693a9"]]},{"id":"62036bcf.fca324","type":"comment","z":"d5a50fbf.bae36","name":"最も古い分類器の削除（感情）","info":"","x":150,"y":240,"wires":[]},{"id":"da42a9f0.a1cb18","type":"inject","z":"d5a50fbf.bae36","name":"分類器情報の削除","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":150,"y":400,"wires":[["fcfa635e.c146c"]]},{"id":"9b06c740.f91298","type":"switch","z":"d5a50fbf.bae36","name":"","property":"count","propertyType":"msg","rules":[{"t":"lte","v":"0","vt":"str"},{"t":"gt","v":"0","vt":"str"}],"checkall":"true","outputs":2,"x":670,"y":400,"wires":[["8141dc2a.9c468"],["284e16dc.049b0a"]]},{"id":"284e16dc.049b0a","type":"function","z":"d5a50fbf.bae36","name":"削除対象抽出","func":"msg.count--;\nmsg.payload = msg.target[msg.count];\nreturn msg;","outputs":1,"noerr":0,"x":820,"y":420,"wires":[["3f9772b3.e83efe","754f370e.e03c08"]]},{"id":"8141dc2a.9c468","type":"debug","z":"d5a50fbf.bae36","name":"終了","active":true,"console":"false","complete":"count","x":790,"y":380,"wires":[]},{"id":"f38beacf.4729b8","type":"delay","z":"d5a50fbf.bae36","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":540,"y":440,"wires":[["9b06c740.f91298"]]},{"id":"f7e22af0.44c5e8","type":"link in","z":"d5a50fbf.bae36","name":"分類器削除(in)","links":["6d6406ab.30b638"],"x":435,"y":440,"wires":[["f38beacf.4729b8"]]},{"id":"d37bba18.dd4798","type":"comment","z":"d5a50fbf.bae36","name":"分類器の削除（classifier_id指定）","info":"","x":160,"y":360,"wires":[]},{"id":"754f370e.e03c08","type":"cloudant in","z":"d5a50fbf.bae36","name":"検索","cloudant":"","database":"classifiers","service":"node-red-twitter-okano-cloudantNoSQLDB","search":"_id_","design":"","index":"","x":970,"y":460,"wires":[["c939ee07.d0281"]]},{"id":"3f9772b3.e83efe","type":"watson-natural-language-classifier","z":"d5a50fbf.bae36","name":"分類器削除","mode":"remove","language":"en","classifier":"","x":990,"y":420,"wires":[["719e4c48.b28db4","6d6406ab.30b638"]]},{"id":"c939ee07.d0281","type":"cloudant out","z":"d5a50fbf.bae36","name":"削除","cloudant":"","database":"classifiers","service":"node-red-twitter-okano-cloudantNoSQLDB","payonly":false,"operation":"delete","x":1090,"y":460,"wires":[]},{"id":"719e4c48.b28db4","type":"debug","z":"d5a50fbf.bae36","name":"","active":true,"console":"false","complete":"false","x":1150,"y":420,"wires":[]},{"id":"6d6406ab.30b638","type":"link out","z":"d5a50fbf.bae36","name":"分類器削除(out)","links":["f7e22af0.44c5e8"],"x":1095,"y":380,"wires":[]},{"id":"99f4da56.5c0168","type":"switch","z":"67acfac.37c5304","name":"クラス数分繰り返し","property":"remains","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"},{"t":"lte","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":640,"y":600,"wires":[["b5d36f14.1dc6b"],["eb2a5498.100278"]]},{"id":"b5d36f14.1dc6b","type":"function","z":"67acfac.37c5304","name":"クエリセット","func":"msg.remains--;\n\nvar startDate = new Date(); \nvar endDate = new Date(); \nvar startHour = \"\";\nvar startMinute = \"\";\nvar endHour = \"\";\nvar endMinute = \"\";\n\nvar groupLevel;\n\nswitch (msg.timeRange) {\n    case \"minutely\":\n        startDate.setHours(startDate.getHours() + 8);\n        startDate.setMinutes(startDate.getMinutes() + 1);\n        endDate.setHours(endDate.getHours() + 9);\n        endDate.setMinutes(endDate.getMinutes() + 1);\n        startHour = \",\" + startDate.getHours();\n        startMinute = \",\" + startDate.getMinutes();\n        endHour = \",\" + endDate.getHours();\n        endMinute = \",\" + endDate.getMinutes();\n        groupLevel = 7;\n        break;\n\n    case \"hourly\":\n        startDate.setDate(startDate.getDate() - 1);\n        startDate.setHours(startDate.getHours() + 10);\n        endDate.setHours(endDate.getHours() + 10);\n        startHour = \",\" + startDate.getHours();\n        endHour = \",\" + endDate.getHours();\n        groupLevel = 6;\n        break;\n\n    case \"daily\":\n        var endOfLastMonth = new Date(startDate.getFullYear(), startDate.getMonth(), 0).getDate();\n        startDate.setDate(startDate.getDate() - endOfLastMonth + 1);\n        startDate.setHours(startDate.getHours() + 9);\n        endDate.setDate(endDate.getDate() + 1);\n        endDate.setHours(endDate.getHours() + 9);\n        groupLevel = 5;\n        break;\n\n    default:\n        break;\n}\n\nvar startYear = startDate.getFullYear();\nvar startMonth = startDate.getMonth()+1;\nvar startDay = startDate.getDate();\n\nvar endYear = endDate.getFullYear();\nvar endMonth = endDate.getMonth()+1;\nvar endDay = endDate.getDate();\n\nvar param = \"group_level=\" + groupLevel +\n            \"&startkey=[\" +\n                \"\\\"\" + global.get(msg.classifier).class[msg.remains] + \"\\\",\" +\n                startYear + \",\" +\n                startMonth + \",\" +\n                startDay +\n                startHour +\n                startMinute +\n            \"]\" +\n            \"&endkey=[\" +\n                \"\\\"\" + global.get(msg.classifier).class[msg.remains] + \"\\\",\" +\n                endYear + \",\" +\n                endMonth + \",\" +\n                endDay +\n                endHour +\n                endMinute +\n            \"]\";\nmsg.url = encodeURI(global.get(\"cloudant.url\") + \"/\" + global.get(\"cloudant.dbname\") + \"/_design/view/_view/count_by_time?\" + param);\n\nmsg.now = endDate;\nmsg.groupLevel = groupLevel;\n\nreturn msg;","outputs":1,"noerr":0,"x":460,"y":440,"wires":[[]]},{"id":"64d4eeb3.309cc","type":"function","z":"67acfac.37c5304","name":"データ整形","func":"var level = msg.groupLevel - 2;\n\nvar count = {};\nmsg.payload.rows.forEach(function(row) {\n    if(!count[row.key[level]]) count[row.key[level]] = 0;\n    count[row.key[level]] += row.value;\n})\n\nvar data = [];\nvar timeRange;\nvar now;\n\nswitch (msg.timeRange) {\n    case \"minutely\":\n        timeRange = 60;\n        now = msg.now.getMinutes();\n        break;\n\n    case \"hourly\":\n        timeRange = 24;\n        now = msg.now.getHours();\n        break;\n\n    case \"daily\":\n        var endOfLastMonth = new Date(msg.now.getFullYear(), msg.now.getMonth(), 0).getDate();\n        timeRange = endOfLastMonth;\n        now = msg.now.getDate();\n        break;\n\n    default:\n        break;\n}\n\nfor (i=0; i < timeRange; i++) {\n    if (count[now]) {\n        data[i] = count[now];\n    } else {\n        data[i] = 0;\n    }\n\n    now++;\n    if (msg.timeRange == \"daily\" ) {\n        if (now > timeRange) now = 1;\n    } else {\n        if (now >= timeRange) now = 0;\n    }\n}\n\nmsg.data[msg.remains] = data;\n\nreturn msg;","outputs":1,"noerr":0,"x":710,"y":520,"wires":[["99f4da56.5c0168"]]},{"id":"eb2a5498.100278","type":"function","z":"67acfac.37c5304","name":"データマージ","func":"var graph = [{\n              series: [],\n              data: [[]],\n              labels: []\n            }];\n\ngraph[0].series = global.get(msg.classifier).class;\n\nvar level = msg.groupLevel - 2;\n\ngraph[0].data = msg.data;\n\nvar timeRange;\nvar now;\n\nswitch (msg.timeRange) {\n    case \"minutely\":\n        timeRange = 60;\n        now = msg.now.getMinutes();\n        break;\n\n    case \"hourly\":\n        timeRange = 24;\n        now = msg.now.getHours();\n        break;\n\n    case \"daily\":\n        var endOfLastMonth = new Date(msg.now.getFullYear(), msg.now.getMonth(), 0).getDate();\n        timeRange = endOfLastMonth;\n        now = msg.now.getDate();\n        break;\n\n    default:\n        break;\n}\n\nfor (i=0; i < timeRange; i++) {\n    graph[0].labels[i] = now;\n    \n    now++;\n    if (msg.timeRange == \"daily\" ) {\n        if (now > timeRange) now = 1;\n    } else {\n        if (now >= timeRange) now = 0;\n    }\n}\n\nmsg.payload = graph;\n\nreturn msg;","outputs":1,"noerr":0,"x":660,"y":660,"wires":[["5b0599df.c26e58"]]},{"id":"9235d3f6.fb08f","type":"ui_chart","z":"67acfac.37c5304","name":"","group":"a4898cff.016c6","order":1,"width":0,"height":0,"label":"分","chartType":"line","legend":"false","xformat":"auto","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1050,"y":420,"wires":[[],[]]},{"id":"6af25de.0125ea4","type":"ui_chart","z":"67acfac.37c5304","name":"","group":"a4898cff.016c6","order":2,"width":0,"height":0,"label":"時","chartType":"line","legend":"false","xformat":"auto","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1050,"y":500,"wires":[[],[]]},{"id":"aaff6bb5.99ad38","type":"ui_chart","z":"67acfac.37c5304","name":"","group":"a4898cff.016c6","order":3,"width":0,"height":0,"label":"日","chartType":"line","legend":"false","xformat":"D/M","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"5","removeOlderPoints":"31","removeOlderUnit":"604800","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":1050,"y":580,"wires":[[],[]]},{"id":"6e8f342a.1c067c","type":"switch","z":"67acfac.37c5304","name":"単位振分","property":"timeRange","propertyType":"msg","rules":[{"t":"eq","v":"minutely","vt":"str"},{"t":"eq","v":"hourly","vt":"str"},{"t":"eq","v":"daily","vt":"str"}],"checkall":"true","outputs":3,"x":900,"y":1020,"wires":[["a14c18bd.4329d8"],["30426667.bb1e4a"],["8772cc0f.f90c3"]]},{"id":"e4af8500.9e07c8","type":"change","z":"67acfac.37c5304","name":"分類器名セット","rules":[{"t":"set","p":"classifier","pt":"msg","to":"posinega","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":500,"wires":[["b643677a.23ee68"]]},{"id":"b643677a.23ee68","type":"function","z":"67acfac.37c5304","name":"クラス数カウント","func":"msg.remains = global.get(msg.classifier).class.length;\nmsg.data = [[]];\nmsg.timeRange = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":760,"wires":[["b5d36f14.1dc6b"]]},{"id":"63040914.dfb838","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"minutely","payloadType":"str","repeat":"60","crontab":"","once":false,"x":100,"y":420,"wires":[["e4af8500.9e07c8"]]},{"id":"c2f5684e.88a788","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"hourly","payloadType":"str","repeat":"60","crontab":"","once":false,"x":100,"y":500,"wires":[["e4af8500.9e07c8"]]},{"id":"9e33a08b.0e84b","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"daily","payloadType":"str","repeat":"60","crontab":"","once":false,"x":90,"y":580,"wires":[["e4af8500.9e07c8"]]},{"id":"322656db.b64fda","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"hourly","payloadType":"str","repeat":"60","crontab":"","once":false,"x":100,"y":760,"wires":[["8d1ec138.b6aa7"]]},{"id":"214301ea.d400ce","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"minutely","payloadType":"str","repeat":"60","crontab":"","once":false,"x":100,"y":680,"wires":[["8d1ec138.b6aa7"]]},{"id":"bb73eda0.ec59c","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"daily","payloadType":"str","repeat":"60","crontab":"","once":false,"x":90,"y":840,"wires":[["8d1ec138.b6aa7"]]},{"id":"f8178c36.7bc65","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"hourly","payloadType":"str","repeat":"60","crontab":"","once":false,"x":100,"y":1020,"wires":[["50361f9e.9ea01"]]},{"id":"a61e70e2.60c23","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"minutely","payloadType":"str","repeat":"60","crontab":"","once":false,"x":100,"y":940,"wires":[["50361f9e.9ea01"]]},{"id":"915594d9.879b38","type":"inject","z":"67acfac.37c5304","name":"","topic":"","payload":"daily","payloadType":"str","repeat":"60","crontab":"","once":false,"x":90,"y":1100,"wires":[["50361f9e.9ea01"]]},{"id":"5b0599df.c26e58","type":"switch","z":"67acfac.37c5304","name":"分類器振分","property":"classifier","propertyType":"msg","rules":[{"t":"eq","v":"posinega","vt":"str"},{"t":"eq","v":"isbot","vt":"str"},{"t":"eq","v":"emotion","vt":"str"}],"checkall":"true","outputs":3,"x":730,"y":760,"wires":[["3849f515.fa8caa"],["16c4487b.d6d5d8"],["6e8f342a.1c067c"]]},{"id":"3849f515.fa8caa","type":"switch","z":"67acfac.37c5304","name":"単位振分","property":"timeRange","propertyType":"msg","rules":[{"t":"eq","v":"minutely","vt":"str"},{"t":"eq","v":"hourly","vt":"str"},{"t":"eq","v":"daily","vt":"str"}],"checkall":"true","outputs":3,"x":900,"y":500,"wires":[["9235d3f6.fb08f"],["6af25de.0125ea4"],["aaff6bb5.99ad38"]]},{"id":"16c4487b.d6d5d8","type":"switch","z":"67acfac.37c5304","name":"単位振分","property":"timeRange","propertyType":"msg","rules":[{"t":"eq","v":"minutely","vt":"str"},{"t":"eq","v":"hourly","vt":"str"},{"t":"eq","v":"daily","vt":"str"}],"checkall":"true","outputs":3,"x":900,"y":760,"wires":[["3c215b4c.6a1f34"],["3e46f7e9.cb9e58"],["11921f6.ba85ce1"]]},{"id":"88a0230f.c9fa","type":"comment","z":"67acfac.37c5304","name":"Tweet内訳","info":"","x":60,"y":1180,"wires":[]},{"id":"73dea7f7.ac0498","type":"function","z":"67acfac.37c5304","name":"クラス数カウント","func":"msg.remains = global.get(msg.classifier).class.length;\nmsg.count = [];\nmsg.timeRange = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":1760,"wires":[["fcfbd367.347b"]]},{"id":"1cb7348c.adddfb","type":"switch","z":"67acfac.37c5304","name":"クラス数分繰り返し","property":"remains","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"},{"t":"lte","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":300,"y":1880,"wires":[["fcfbd367.347b"],["c219f84a.886408"]]},{"id":"fcfbd367.347b","type":"function","z":"67acfac.37c5304","name":"クエリセット","func":"msg.remains--;\nvar param = \"key=\\\"\" + global.get(msg.classifier).class[msg.remains] + \"\\\"\";\nmsg.url = encodeURI(global.get(\"cloudant.url\") + \"/\" + global.get(\"cloudant.dbname\") + \"/_design/view/_view/count_by_class?\" + param);\n\nreturn msg;","outputs":1,"noerr":0,"x":280,"y":1820,"wires":[[]]},{"id":"c219f84a.886408","type":"function","z":"67acfac.37c5304","name":"データマージ","func":"var graph = [{\n              series: [],\n              data: [[]],\n              labels: []\n            }];\n\ngraph[0].series = global.get(msg.classifier).class;\ngraph[0].labels = global.get(msg.classifier).class;\n\ngraph[0].data[0] = msg.count;\n\nmsg.payload = graph;\n\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":1880,"wires":[["44538efd.143a8"]]},{"id":"47f674f4.8a1ccc","type":"change","z":"67acfac.37c5304","name":"分類器名セット","rules":[{"t":"set","p":"classifier","pt":"msg","to":"posinega","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":1760,"wires":[["73dea7f7.ac0498"]]},{"id":"f56ebb44.1c74c8","type":"function","z":"67acfac.37c5304","name":"カウントセット","func":"if (msg.payload.rows[0]) {\n    msg.count[msg.remains] = msg.payload.rows[0].value;\n} else {\n    msg.count[msg.remains] = 0;\n}\nreturn msg;","outputs":1,"noerr":0,"x":620,"y":1820,"wires":[["1cb7348c.adddfb"]]},{"id":"55bb4411.a2e23c","type":"function","z":"67acfac.37c5304","name":"クラス数カウント","func":"msg.remains = global.get(msg.classifier).class.length;\nmsg.count = [];\nmsg.timeRange = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":1960,"wires":[["ba04aaf7.cd7d48"]]},{"id":"63d683fa.c8460c","type":"function","z":"67acfac.37c5304","name":"データマージ","func":"var graph = [{\n              series: [],\n              data: [[]],\n              labels: []\n            }];\n\ngraph[0].series = global.get(msg.classifier).class;\ngraph[0].labels = global.get(msg.classifier).class;\n\ngraph[0].data[0] = msg.count;\n\nmsg.payload = graph;\n\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":2080,"wires":[["507ff7ef.8ee018"]]},{"id":"ba04aaf7.cd7d48","type":"function","z":"67acfac.37c5304","name":"クエリセット","func":"msg.remains--;\nvar param = \"key=\\\"\" + global.get(msg.classifier).class[msg.remains] + \"\\\"\";\nmsg.url = encodeURI(global.get(\"cloudant.url\") + \"/\" + global.get(\"cloudant.dbname\") + \"/_design/view/_view/count_by_class?\" + param);\n\nreturn msg;","outputs":1,"noerr":0,"x":280,"y":2020,"wires":[[]]},{"id":"c5454505.f93358","type":"switch","z":"67acfac.37c5304","name":"クラス数分繰り返し","property":"remains","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"},{"t":"lte","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":300,"y":2080,"wires":[["ba04aaf7.cd7d48"],["63d683fa.c8460c"]]},{"id":"926eee8c.ba2f","type":"function","z":"67acfac.37c5304","name":"カウントセット","func":"if (msg.payload.rows[0]) {\n    msg.count[msg.remains] = msg.payload.rows[0].value;\n} else {\n    msg.count[msg.remains] = 0;\n}\nreturn msg;","outputs":1,"noerr":0,"x":620,"y":2020,"wires":[["c5454505.f93358"]]},{"id":"8e5bf87a.fe69a8","type":"function","z":"67acfac.37c5304","name":"クラス数カウント","func":"msg.remains = global.get(msg.classifier).class.length;\nmsg.count = [];\nmsg.timeRange = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":2160,"wires":[["296d6a4a.127e96"]]},{"id":"d66448bb.d86eb8","type":"function","z":"67acfac.37c5304","name":"データマージ","func":"var graph = [{\n              series: [],\n              data: [[]],\n              labels: []\n            }];\n\ngraph[0].series = global.get(msg.classifier).class;\ngraph[0].labels = global.get(msg.classifier).class;\n\ngraph[0].data[0] = msg.count;\n\nmsg.payload = graph;\n\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":2280,"wires":[["6e4fd0cf.48c35"]]},{"id":"296d6a4a.127e96","type":"function","z":"67acfac.37c5304","name":"クエリセット","func":"msg.remains--;\nvar param = \"key=\\\"\" + global.get(msg.classifier).class[msg.remains] + \"\\\"\";\nmsg.url = encodeURI(global.get(\"cloudant.url\") + \"/\" + global.get(\"cloudant.dbname\") + \"/_design/view/_view/count_by_class?\" + param);\n\nreturn msg;","outputs":1,"noerr":0,"x":280,"y":2220,"wires":[[]]},{"id":"88e88382.77b74","type":"switch","z":"67acfac.37c5304","name":"クラス数分繰り返し","property":"remains","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"},{"t":"lte","v":"0","vt":"num"}],"checkall":"true","outputs":2,"x":300,"y":2280,"wires":[["296d6a4a.127e96"],["d66448bb.d86eb8"]]},{"id":"38479a2c.64fed6","type":"function","z":"67acfac.37c5304","name":"カウントセット","func":"if (msg.payload.rows[0]) {\n    msg.count[msg.remains] = msg.payload.rows[0].value;\n} else {\n    msg.count[msg.remains] = 0;\n}\nreturn msg;","outputs":1,"noerr":0,"x":620,"y":2220,"wires":[["88e88382.77b74"]]},{"id":"a118ff1d.010b9","type":"inject","z":"67acfac.37c5304","name":"1週間より前のデータ削除","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"00 01 * * *","once":false,"x":160,"y":240,"wires":[["a76ecb7d.4b6548"]]},{"id":"a76ecb7d.4b6548","type":"function","z":"67acfac.37c5304","name":"クエリセット","func":"msg.remains--;\n\nvar endDate = new Date(); \n\nendDate.setDate(endDate.getDate() - 7);\nendDate.setHours(endDate.getHours() + 9);\n\nvar endYear = endDate.getFullYear();\nvar endMonth = endDate.getMonth()+1;\nvar endDay = endDate.getDate();\n\nvar param = \"endkey=[\" +\n                endYear + \",\" +\n                endMonth + \",\" +\n                endDay +\n            \"]\";\nmsg.url = encodeURI(global.get(\"cloudant.url\") + \"/\" + global.get(\"cloudant.dbname\") + \"/_design/view/_view/sort_by_date?\" + param);\n\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":240,"wires":[[]]},{"id":"27e12ac.37b73d6","type":"function","z":"67acfac.37c5304","name":"削除クエリセット","func":"msg.url = encodeURI(global.get(\"cloudant.url\") + \"/\" +  global.get(\"cloudant.dbname\") + \"/_bulk_docs\");\n\nvar docs = [{ \"_id\":\"\",\n              \"_rev\":\"\",\n              \"_deleted\":\"\"}];\n\nif(Array.isArray(msg.payload.rows)) {\n    for (i = 0; i < msg.payload.rows.length; i++) {\n        if (msg.payload.rows[i]) {\n            docs[i] = { \"_id\" : msg.payload.rows[i].value._id,\n                        \"_rev\" : msg.payload.rows[i].value._rev,\n                        \"_deleted\" : true};\n        }\n    }\n}\n\nmsg.payload = { \"docs\":docs };\n\nreturn msg;","outputs":1,"noerr":0,"x":730,"y":240,"wires":[["987cc4a0.4de768"]]},{"id":"987cc4a0.4de768","type":"http request","z":"67acfac.37c5304","name":"","method":"POST","ret":"obj","url":"","tls":"","x":910,"y":240,"wires":[[]]},{"id":"c773b540.921ae8","type":"delay","z":"7b39f5db.8af62c","name":"","pauseType":"delay","timeout":"20","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"200","randomLast":"1","randomUnits":"milliseconds","drop":false,"x":270,"y":160,"wires":[["2fd0bc1d.f93e24"]]},{"id":"2fd0bc1d.f93e24","type":"switch","z":"7b39f5db.8af62c","name":"流量制限","property":"request.count","propertyType":"global","rules":[{"t":"lt","v":"2","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":260,"y":100,"wires":[["1eca8761.cbad09"],["c773b540.921ae8"]]},{"id":"a7ff3786.e7dd78","type":"http request","z":"7b39f5db.8af62c","name":"","method":"GET","ret":"obj","url":"","tls":"","x":590,"y":80,"wires":[["15e96158.b48c2f"]]},{"id":"a5c1c8f2.b49098","type":"delay","z":"7b39f5db.8af62c","name":"","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1000","randomLast":"1","randomUnits":"milliseconds","drop":false,"x":120,"y":100,"wires":[["2fd0bc1d.f93e24"]]},{"id":"15e96158.b48c2f","type":"switch","z":"7b39f5db.8af62c","name":"エラー検知","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":750,"y":80,"wires":[[],["8f0c1f74.f6357"]]},{"id":"1eca8761.cbad09","type":"function","z":"7b39f5db.8af62c","name":"流量カウント","func":"var count = global.get('request.count');\ncount++;\nglobal.set('request.count',count);\nreturn msg;","outputs":1,"noerr":0,"x":420,"y":80,"wires":[["a7ff3786.e7dd78"]]},{"id":"8f0c1f74.f6357","type":"function","z":"7b39f5db.8af62c","name":"リトライセット","func":"msg.retryCount = msg.retryCount || 0;\nmsg.retryCount++;\n\nmsg.payload = {};\nmsg.responseUrl = null;\nmsg.headers = null;\nmsg.statusCode = null;\nreturn msg;","outputs":1,"noerr":0,"x":920,"y":100,"wires":[["d8b2cfec.d9c0d"]]},{"id":"d8b2cfec.d9c0d","type":"switch","z":"7b39f5db.8af62c","name":"リトライ上限","property":"retryCount","propertyType":"msg","rules":[{"t":"gt","v":"20","vt":"num"},{"t":"else"}],"checkall":"true","outputs":2,"x":1100,"y":100,"wires":[[],["c773b540.921ae8"]]}]
